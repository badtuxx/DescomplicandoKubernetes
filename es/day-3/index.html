
<!DOCTYPE HTML>
<html lang="es" >
    <head>
        <meta charset="UTF-8">
        <title>Simplificando Kubernetes día 3 · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.6.20">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../day-4/" />
    
    
    <link rel="prev" href="../day-2/" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Escribe para buscar" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Acerca de</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introducción
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Capítulos</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../day-1/">
            
                <a href="../day-1/">
            
                    
                    Simplificando Kubernetes día 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../day-2/">
            
                <a href="../day-2/">
            
                    
                    Simplificando Kubernetes día 2
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.3" data-path="./">
            
                <a href="./">
            
                    
                    Simplificando Kubernetes día 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../day-4/">
            
                <a href="../day-4/">
            
                    
                    Simplificando Kubernetes día 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../day-5/">
            
                <a href="../day-5/">
            
                    
                    Simplificando Kubernetes día 5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../day-6/">
            
                <a href="../day-6/">
            
                    
                    Simplificando Kubernetes día 6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="../day-7/">
            
                <a href="../day-7/">
            
                    
                    Simplificando Kubernetes día 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="../day-8/">
            
                <a href="../day-8/">
            
                    
                    Simplificando Kubernetes día 8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="../day-9/">
            
                <a href="../day-9/">
            
                    
                    Simplificando Kubernetes día 9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="../day-10/">
            
                <a href="../day-10/">
            
                    
                    Simplificando Kubernetes día 10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="../day-11/">
            
                <a href="../day-11/">
            
                    
                    Simplificando Kubernetes día 11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="../day-12/">
            
                <a href="../day-12/">
            
                    
                    Simplificando Kubernetes día 12
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="../day-13/">
            
                <a href="../day-13/">
            
                    
                    Simplificando Kubernetes día 13
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="../day-14/">
            
                <a href="../day-14/">
            
                    
                    Simplificando Kubernetes día 14
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="../day-15/">
            
                <a href="../day-15/">
            
                    
                    Simplificando Kubernetes día 15
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Contribuir</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../CONTRIBUTING.html">
            
                <a href="../CONTRIBUTING.html">
            
                    
                    Cómo ayudar
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Publicado con HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Simplificando Kubernetes día 3</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="simplificando-kubernetes">Simplificando Kubernetes</h1>
<h2 id="día-3">Día 3</h2>
<p> </p>
<h3 id="contenido-del-día-3">Contenido del Día 3</h3>
<ul>
<li><a href="#simplificando-kubernetes">Simplificando Kubernetes</a><ul>
<li><a href="#día-3">Día 3</a><ul>
<li><a href="#contenido-del-día-3">Contenido del Día 3</a></li>
<li><a href="#inicio-de-la-lección-del-día-3">Inicio de la Lección del Día 3</a></li>
<li><a href="#qué-veremos-hoy">¿Qué veremos hoy?</a></li>
<li><a href="#qué-es-un-deployment">¿Qué es un Deployment?</a><ul>
<li><a href="#cómo-crear-un-deployment">Cómo crear un Deployment</a></li>
<li><a href="#qué-significa-cada-parte-del-archivo">¿Qué significa cada parte del archivo?</a></li>
<li><a href="#cómo-aplicar-el-deployment">¿Cómo aplicar el Deployment?</a></li>
<li><a href="#cómo-verificar-si-el-deployment-se-ha-creado">¿Cómo verificar si el Deployment se ha creado?</a></li>
<li><a href="#cómo-verificar-los-pods-que-el-deployment-está-gestionando">¿Cómo verificar los Pods que el Deployment está gestionando?</a></li>
<li><a href="#cómo-verificar-el-replicaset-que-el-deployment-está-gestionando">Cómo verificar el ReplicaSet que el Deployment está gestionando?</a></li>
<li><a href="#cómo-verificar-los-detalles-del-deployment">Cómo verificar los detalles del Deployment?</a></li>
<li><a href="#cómo-actualizar-el-deployment">Cómo actualizar el Deployment?</a></li>
<li><a href="#cuál-es-la-estrategia-de-actualización-predeterminada-del-deployment">¿Cuál es la estrategia de actualización predeterminada del Deployment?</a></li>
<li><a href="#estrategias-de-actualización-del-deployment">Estrategias de actualización del Deployment</a><ul>
<li><a href="#estrategia-rollingupdate-actualización-gradual">Estrategia RollingUpdate (Actualización gradual)</a></li>
<li><a href="#estrategia-recreate">Estrategia Recreate</a></li>
</ul>
</li>
<li><a href="#realizando-un-rollback-de-una-actualización">Realizando un rollback de una actualización</a></li>
<li><a href="#eliminando-un-deployment">Eliminando un Deployment</a></li>
<li><a href="#conclusión">Conclusión</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p> </p>
<h3 id="inicio-de-la-lección-del-día-3">Inicio de la Lección del Día 3</h3>
<p> </p>
<h3 id="¿qué-veremos-hoy">¿Qué veremos hoy?</h3>
<p>Durante el día de hoy, aprenderemos acerca de un objeto muy importante en Kubernetes: el <strong>Deployment</strong> (Implementación). Veremos todos los detalles para obtener una comprensión completa de qué es un Deployment y cómo funciona. Ahora que ya sabemos todo acerca de cómo crear un Pod, creo que es momento de agregar un poco más de complejidad a nuestro escenario, ¿no te parece? ¡Vamos a por ello!
 </p>
<h3 id="¿qué-es-un-deployment">¿Qué es un Deployment?</h3>
<p>En Kubernetes, un <strong>Deployment</strong> es un objeto crucial que representa una aplicación. Su función principal es administrar los Pods que componen la aplicación. Un Deployment es una abstracción que nos permite actualizar los Pods e incluso realizar un rollback a una versión anterior en caso de problemas.</p>
<p>Cuando creamos un Deployment, podemos definir el número de réplicas que deseamos mantener. El Deployment se asegurará de que el número de Pods bajo su administración sea igual al número de réplicas definidas. Si un Pod falla, el Deployment creará un nuevo Pod para reemplazarlo. Esto resulta de gran ayuda para mantener alta la disponibilidad de la aplicación.</p>
<p>El enfoque del Deployment es declarativo, lo que significa que definimos el estado deseado y el propio Deployment se encarga de realizar las acciones necesarias para que el estado actual coincida con el deseado.</p>
<p>Cuando creamos un Deployment, automáticamente se genera un objeto llamado ReplicaSet. El ReplicaSet es el encargado de gestionar los Pods para el Deployment, mientras que el Deployment se encarga de administrar los ReplicaSets. Como mencioné, un ReplicaSet se crea automáticamente junto con el Deployment, pero también podemos crear un ReplicaSet de forma manual si es necesario. Abordaremos este tema con más detalle en el próximo día, ya que hoy nuestro enfoque está en el Deployment.</p>
<p> </p>
<h4 id="cómo-crear-un-deployment">Cómo crear un Deployment</h4>
<p>Para crear un Deployment, necesitamos un archivo YAML. Creemos un archivo llamado <strong>deployment.yaml</strong> y agreguemos el siguiente contenido:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-deployment</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">strategy:</span> {}
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">nginx</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span>
        <span class="hljs-attr">resources:</span>
          <span class="hljs-attr">limits:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.5&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">256Mi</span>
          <span class="hljs-attr">requests:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.25&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span>
</code></pre>
<p> </p>
<h4 id="¿qué-significa-cada-parte-del-archivo">¿Qué significa cada parte del archivo?</h4>
<pre><code class="lang-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
</code></pre>
<p>Aquí estamos definiendo que el tipo de objeto que estamos creando es un Deployment y la versión de la API que estamos utilizando es <strong>apps/v1</strong>.</p>
<p> </p>
<pre><code class="lang-yaml"><span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-deployment</span>
</code></pre>
<p>Aquí estamos definiendo el nombre del Deployment, que es <strong>nginx-deployment</strong>, y también estamos definiendo las etiquetas (labels) que se agregarán al Deployment. Las etiquetas se utilizan para identificar los objetos en Kubernetes.</p>
<p> </p>
<pre><code class="lang-yaml"><span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
</code></pre>
<p>Aquí estamos definiendo el número de réplicas que tendrá el Deployment. En este caso, estamos configurando el Deployment para tener 3 réplicas.</p>
<p> </p>
<pre><code class="lang-yaml"><span class="hljs-attr">selector:</span>
  <span class="hljs-attr">matchLabels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
</code></pre>
<p>Aquí estamos definiendo el selector que se utilizará para identificar los Pods que el Deployment gestionará. En este caso, estamos configurando el Deployment para gestionar los Pods que tengan la etiqueta <strong>app: nginx-deployment</strong>.</p>
<p> </p>
<pre><code class="lang-yaml"><span class="hljs-attr">strategy:</span> {}
</code></pre>
<p>Aquí estamos definiendo la estrategia que se utilizará para actualizar los Pods. En este caso, estamos dejando la estrategia predeterminada, que es la estrategia de Rolling Update, lo que significa que el Deployment actualizará los Pods uno por uno. Entraremos en más detalles sobre las estrategias más adelante.</p>
<p> </p>
<pre><code class="lang-yaml"><span class="hljs-attr">template:</span>
  <span class="hljs-attr">metadata:</span>
    <span class="hljs-attr">labels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">spec:</span>
    <span class="hljs-attr">containers:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">nginx</span>
      <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span>
      <span class="hljs-attr">resources:</span>
        <span class="hljs-attr">limits:</span>
          <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.5&quot;</span>
          <span class="hljs-attr">memory:</span> <span class="hljs-string">256Mi</span>
        <span class="hljs-attr">requests:</span>
          <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.25&quot;</span>
          <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span>
</code></pre>
<p>Aquí estamos definiendo la plantilla que se utilizará para crear los Pods. En este caso, estamos definiendo que la plantilla usará la imagen <strong>nginx</strong> y que el nombre del contenedor será <strong>nginx</strong>. También estamos definiendo los límites de CPU y memoria que el contenedor podrá utilizar. Esta definición es idéntica a lo que vimos en el Día 2, cuando creamos un Pod.
 </p>
<p>Simple, ¿verdad? Ahora vamos a aplicar el Deployment.</p>
<h4 id="¿cómo-aplicar-el-deployment">¿Cómo aplicar el Deployment?</h4>
<p>Para aplicar el Deployment, necesitamos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl apply -f deployment.yaml
</code></pre>
<p> </p>
<h4 id="¿cómo-verificar-si-el-deployment-se-ha-creado">¿Cómo verificar si el Deployment se ha creado?</h4>
<p>Para verificar si el Deployment se ha creado, debemos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl get deployments -l app=nginx-deployment
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">NAME                               READY   STATUS    RESTARTS   AGE
nginx-deployment-78cd4b8fd-r4zk8   1/1     Running   0          5s
</code></pre>
<h4 id="¿cómo-verificar-los-pods-que-el-deployment-está-gestionando">¿Cómo verificar los Pods que el Deployment está gestionando?</h4>
<p>Para verificar los Pods que el Deployment está gestionando, debemos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl get pods -l app=nginx
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">NAME                               READY   STATUS    RESTARTS   AGE
nginx-deployment-78cd4b8fd-8b8mm   1/1     Running   0          44s
nginx-deployment-78cd4b8fd-kn4v8   1/1     Running   0          44s
nginx-deployment-78cd4b8fd-xqn5g   1/1     Running   0          44s
</code></pre>
<p>Esto sucede porque el selector del Deployment es <strong>app: nginx</strong> y las etiquetas de los Pods que el Deployment está gestionando son <strong>app: nginx</strong>, ¿recuerdas que definimos esto en la plantilla del Deployment?</p>
<p> </p>
<h4 id="cómo-verificar-el-replicaset-que-el-deployment-está-gestionando">Cómo verificar el ReplicaSet que el Deployment está gestionando?</h4>
<p>Si deseas listar los ReplicaSets que el Deployment está gestionando, puedes ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl get replicasets -l app=nginx
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">NAME                         DESIRED   CURRENT   READY   AGE
nginx-deployment-78cd4b8fd   3         3         3       88s
</code></pre>
<p>Recuerda que entraremoen detalles sobre los ReplicaSets más adelante.</p>
<p> </p>
<h4 id="cómo-verificar-los-detalles-del-deployment">Cómo verificar los detalles del Deployment?</h4>
<p>Para verificar los detalles del Deployment, debemos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl describe deployment nginx-deployment
</code></pre>
<p>En la salida del comando <code>kubectl describe deployment nginx-deployment</code>, encontraremos información importante sobre el Deployment, como por ejemplo:</p>
<ul>
<li>El nombre del Deployment</li>
<li>El Namespace en el que se encuentra el Deployment</li>
<li>Las etiquetas que tiene el Deployment</li>
<li>La cantidad de réplicas que tiene el Deployment</li>
<li>El selector que el Deployment utiliza para identificar los Pods que gestionará</li>
<li>Límites de CPU y memoria que el Deployment utilizará</li>
<li>La plantilla del Pod que el Deployment utilizará para crear los Pods</li>
<li>La estrategia que el Deployment utilizará para actualizar los Pods</li>
<li>El ReplicaSet que el Deployment está gestionando</li>
<li>Los eventos que han ocurrido en el Deployment</li>
</ul>
<p>Vamos echar un vistazo a una parte de la salida del comando <code>kubectl describe deployment nginx-deployment</code>:</p>
<pre><code class="lang-bash">Name:                   nginx-deployment
Namespace:              default
CreationTimestamp:      Fri, 20 Jan 2023 19:05:29 +0100
Labels:                 app=nginx-deployment
Annotations:            deployment.kubernetes.io/revision: 1
Selector:               app=nginx-deployment
Replicas:               3 desired | 3 updated | 3 total | 3 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=nginx-deployment
  Containers:
   nginx:
    Image:      nginx
    Port:       &lt;none&gt;
    Host Port:  &lt;none&gt;
    Limits:
      cpu:     500m
      memory:  256Mi
    Requests:
      cpu:        250m
      memory:     128Mi
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &lt;none&gt;
NewReplicaSet:   nginx-deployment-78cd4b8fd (3/3 replicas created)
Events:
  Type    Reason             Age    From                   Message
  ----    ------             ----   ----                   -------
  Normal  ScalingReplicaSet  3m13s  deployment-controller  Scaled up replica <span class="hljs-built_in">set</span> nginx-deployment-78cd4b8fd to 3
</code></pre>
<p> </p>
<h4 id="cómo-actualizar-el-deployment">Cómo actualizar el Deployment?</h4>
<p>Supongamos que ahora necesitamos utilizar una versión específica de la imagen de Nginx en el Deployment, para lograrlo, necesitamos modificar el archivo <code>deployment.yaml</code> y cambiar la versión de la imagen por <strong>nginx:1.16.0</strong>, por ejemplo.</p>
<pre><code class="lang-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-deployment</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">strategy:</span> {}
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.16.0</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span>
        <span class="hljs-attr">resources:</span>
          <span class="hljs-attr">limits:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.5&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">256Mi</span>
          <span class="hljs-attr">requests:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.25&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span>
</code></pre>
<p>Ahora que hemos modificado la versión de la imagen de Nginx, necesitamos aplicar los cambios al Deployment. Para ello, ejecutamos el siguiente comando:</p>
<pre><code class="lang-bash">kubectl apply -f deployment.yaml
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment configured
</code></pre>
<p>&quot;
Vamos a ver los detalles del Deployment para verificar si se ha modificado la versión de la imagen:</p>
<pre><code class="lang-bash">kubectl describe deployment nginx-deployment
</code></pre>
<p>En la salida del comando, podemos ver la línea donde se encuentra la versión de la imagen de Nginx:</p>
<pre><code class="lang-bash">Containers:
   nginx:
    Image:      nginx:1.16.0
    Port:       &lt;none&gt;
    Host Port:  &lt;none&gt;
    Limits:
      cpu:     500m
      memory:  256Mi
    Requests:
      cpu:        250m
      memory:     128Mi
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
</code></pre>
<p> </p>
<h4 id="¿cuál-es-la-estrategia-de-actualización-predeterminada-del-deployment">¿Cuál es la estrategia de actualización predeterminada del Deployment?</h4>
<p>Cuando creamos nuestro Deployment, no especificamos ninguna estrategia de actualización, por lo que Kubernetes utiliza la estrategia de actualización predeterminada, que es la estrategia RollingUpdate.</p>
<p>La estrategia RollingUpdate es la estrategia de actualización estándar en Kubernetes. Se utiliza para actualizar los Pods de un Deployment de manera gradual, es decir, actualiza un Pod a la vez o un grupo de Pods a la vez.</p>
<p>Podemos definir cómo será la actualización de los Pods, por ejemplo, podemos especificar la cantidad máxima de Pods que pueden estar no disponibles durante la actualización, o podemos definir la cantidad máxima de Pods que se pueden crear durante la actualización.</p>
<p>Vamos a comprender un poco mejor cómo funciona esto en el próximo tema.</p>
<h4 id="estrategias-de-actualización-del-deployment">Estrategias de actualización del Deployment</h4>
<p>Kubernetes tiene 2 estrategias de actualización para los Deployments:</p>
<ul>
<li>RollingUpdate (Actualización gradual)</li>
<li>Recreate (Recreación)</li>
</ul>
<p>Vamos a entender un poco mejor cada una de estas estrategias.</p>
<h5 id="estrategia-rollingupdate-actualización-gradual">Estrategia RollingUpdate (Actualización gradual)</h5>
<p>La estrategia RollingUpdate es la estrategia de actualización predeterminada en Kubernetes. Se utiliza para actualizar los Pods de un Deployment de manera gradual, es decir, actualiza un Pod a la vez o un grupo de Pods a la vez.</p>
<p>Podemos definir cómo será la actualización de los Pods. Por ejemplo, podemos especificar la cantidad máxima de Pods que pueden estar no disponibles durante la actualización, o la cantidad máxima de Pods que se pueden crear durante la actualización.</p>
<p>También vamos a aumentar la cantidad de réplicas del Deployment a 10, para tener más Pods para actualizar.</p>
<p>Y para poder probar la estrategia RollingUpdate, vamos a cambiar la versión de la imagen de Nginx a 1.15.0.</p>
<p>Para configurar estas opciones, debemos modificar el archivo <code>deployment.yaml</code> y agregar las siguientes configuraciones:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-deployment</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">10</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">strategy:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">RollingUpdate</span>
    <span class="hljs-attr">rollingUpdate:</span>
      <span class="hljs-attr">maxSurge:</span> <span class="hljs-number">1</span>
      <span class="hljs-attr">maxUnavailable:</span> <span class="hljs-number">2</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.15.0</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span>
        <span class="hljs-attr">resources:</span>
          <span class="hljs-attr">limits:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.5&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">256Mi</span>
          <span class="hljs-attr">requests:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.25&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span>
</code></pre>
<p>Lo que hemos hecho es agregar las siguientes configuraciones:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">strategy:</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">RollingUpdate</span>
  <span class="hljs-attr">rollingUpdate:</span>
    <span class="hljs-attr">maxSurge:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">maxUnavailable:</span> <span class="hljs-number">2</span>
</code></pre>
<p>Donde:</p>
<ul>
<li><p><code>maxSurge</code>: define la cantidad máxima de Pods que pueden crearse durante la actualización. En otras palabras, durante el proceso de actualización, podemos tener 1 Pod más que la cantidad de Pods definida en el Deployment. Esto es útil para acelerar la actualización, ya que Kubernetes no tiene que esperar a que un Pod se actualice para crear un nuevo Pod.</p>
</li>
<li><p><code>maxUnavailable</code>: define la cantidad máxima de Pods que pueden quedar no disponibles durante la actualización. En otras palabras, durante el proceso de actualización, podemos tener 1 Pod no disponible a la vez. Esto es útil para garantizar que el servicio no quede no disponible durante la actualización.</p>
</li>
<li><p><code>type</code>: define el tipo de estrategia de actualización que se utilizará. En nuestro caso, estamos utilizando la estrategia RollingUpdate.</p>
</li>
</ul>
<p>Ahora que hemos modificado el archivo <code>deployment.yaml</code>, debemos aplicar los cambios al Deployment. Para hacerlo, ejecutamos el siguiente comando:</p>
<pre><code class="lang-bash">kubectl apply -f deployment.yaml
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment configured
</code></pre>
<p>Vamos a verificar si los cambios han sido aplicados en el Deployment:</p>
<pre><code class="lang-bash">kubectl describe deployment nginx-deployment
</code></pre>
<p>En la salida del comando, podemos ver que las líneas donde se encuentran las configuraciones de actualización del Deployment han sido modificadas:</p>
<pre><code class="lang-bash">StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  2 max unavailable, 1 max surge
</code></pre>
<p>Con esta configuración, le estamos indicando a Kubernetes que puede crear hasta 1 Pod adicional durante la actualización, y que puede tener hasta 2 Pods no disponibles durante la actualización, es decir, actualizará de 2 en 2 Pods.</p>
<p>Un comando muy útil para seguir el proceso de actualización de los Pods es:</p>
<pre><code class="lang-bash">kubectl rollout status deployment/nginx-deployment
</code></pre>
<p>El comando <code>rollout status</code> se utiliza para seguir el proceso de actualización de un Deployment, ReplicaSet, DaemonSet, StatefulSet, Job y CronJob. Este comando es muy útil ya que nos informa si el proceso de actualización está en progreso, si se completó con éxito o si falló.</p>
<p>Vamos a ejecutar el comando <code>rollout status</code> para seguir el proceso de actualización del Deployment:</p>
<pre><code class="lang-bash">kubectl rollout status deployment nginx-deployment
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">Waiting <span class="hljs-keyword">for</span> deployment <span class="hljs-string">&quot;nginx-deployment&quot;</span> rollout to finish: 9 of 10 updated replicas are available...
deployment <span class="hljs-string">&quot;nginx-deployment&quot;</span> successfully rolled out
</code></pre>
<p>Como podemos ver, el proceso de actualización se ha completado con éxito.</p>
<p>Vamos a verificar si los Pods se han actualizado:</p>
<pre><code class="lang-bash">kubectl get pods -l app=nginx-deployment -o yaml
</code></pre>
<p>En la salida del comando, podremos ver que los Pods se han actualizado:</p>
<pre><code class="lang-bash">...
  - image: nginx:1.15.0
...
</code></pre>
<p>También podemos verificar la versión de la imagen de Nginx en el Pod:</p>
<pre><code class="lang-bash">kubectl <span class="hljs-built_in">exec</span> -it nginx-deployment-7b7b9c7c9d-4j2xg -- nginx -v
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">nginx version: nginx/1.15.0
</code></pre>
<p>También podemos verificar la versión de la imagen de Nginx en el Pod:</p>
<pre><code class="lang-bash">kubectl <span class="hljs-built_in">exec</span> -it nginx-deployment-7b7b9c7c9d-4j2xg -- nginx -v
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">nginx version: nginx/1.15.0
</code></pre>
<p>El comando <code>nginx -v</code> se utiliza para verificar la versión de Nginx.</p>
<p>Sin embargo, no siempre esta es la mejor estrategia de actualización, ya que puede haber aplicaciones que no admitan dos versiones del mismo servicio ejecutándose al mismo tiempo, por ejemplo.</p>
<p>Si todo funciona como deseamos, ahora podemos probar la estrategia Recreate.</p>
<p> </p>
<h5 id="estrategia-recreate">Estrategia Recreate</h5>
<p>La estrategia Recreate es un enfoque de actualización que eliminará todos los Pods del Deployment y creará nuevos Pods con la nueva versión de la imagen. La ventaja es que la implementación será rápida, pero la desventaja es que el servicio no estará disponible durante el proceso de actualización.</p>
<p>Vamos a cambiar el archivo <code>deployment.yaml</code> para utilizar la estrategia Recreate:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-deployment</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">10</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
  <span class="hljs-attr">strategy:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">Recreate</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">nginx-deployment</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.15.0</span>
        <span class="hljs-attr">name:</span> <span class="hljs-string">nginx</span>
        <span class="hljs-attr">resources:</span>
          <span class="hljs-attr">limits:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.5&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">256Mi</span>
          <span class="hljs-attr">requests:</span>
            <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;0.25&quot;</span>
            <span class="hljs-attr">memory:</span> <span class="hljs-string">128Mi</span>
</code></pre>
<p>Observe que ahora solo tenemos la configuración <code>type: Recreate</code>. Recreate no tiene configuraciones de actualización, es decir, no puedes definir el número máximo de Pods no disponibles durante la actualización, ya que Recreate eliminará todos los Pods del Deployment y creará nuevos Pods.</p>
<p>Una vez que hayamos cambiado el archivo <code>deployment.yaml</code>, necesitamos aplicar los cambios en el Deployment. Para ello, ejecutamos el siguiente comando:</p>
<pre><code class="lang-bash">kubectl apply -f deployment.yaml
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment configured
</code></pre>
<p>Vamos a verificar si los cambios se han aplicado al Deployment:</p>
<pre><code class="lang-bash">kubectl describe deployment nginx-deployment
</code></pre>
<p>En la salida del comando, podremos observar que las líneas donde están las configuraciones de actualización del Deployment han cambiado:</p>
<pre><code class="lang-bash">StrategyType:           Recreate
</code></pre>
<p>Ahora vamos a cambiar nuevamente la versión de la imagen de Nginx a 1.16.0 en el archivo <code>deployment.yaml</code>:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.16.0</span>
</code></pre>
<p>Una vez que hayamos realizado esta modificación en el archivo <code>deployment.yaml</code>, necesitamos aplicar los cambios en el Deployment ejecutando el siguiente comando:</p>
<pre><code class="lang-bash">kubectl apply -f deployment.yaml
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment configurado
</code></pre>
<p>Vamos a verificar los Pods del Despliegue:</p>
<pre><code class="lang-bash">kubectl get pods -l app=nginx-deployment
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">NOMBRE                               LISTO   ESTADO    REINICIOS   EDAD
nginx-deployment-7d9bcc6bc9-24c2j   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-5r69s   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-78mc9   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-7pb2v   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-gvtvl   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-kb9st   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-m69bm   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-qvppt   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-sqn6q   0/1     Pendiente   0          0s
nginx-deployment-7d9bcc6bc9-zthn4   0/1     Pendiente   0          0s
</code></pre>
<p>Podemos observar que los Pods están siendo creados nuevamente, pero con la nueva versión de la imagen del Nginx.</p>
<p>Vamos a verificar la versión de la imagen del Nginx en el Pod:</p>
<pre><code class="lang-bash">kubectl <span class="hljs-built_in">exec</span> -it nginx-deployment-7d9bcc6bc9-24c2j -- nginx -v
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">nginx version: nginx/1.16.0
</code></pre>
<p>Listo, ahora tenemos la versión 1.16.0 de Nginx ejecutándose en nuestro clúster y ya comprendemos cómo funcionan las estrategias de actualización Rolling Update y Recreate.</p>
<p> </p>
<h4 id="realizando-un-rollback-de-una-actualización">Realizando un rollback de una actualización</h4>
<p>Ahora que entendemos cómo funcionan las estrategias Rolling Update y Recreate, vamos a aprender cómo hacer un rollback de una actualización.</p>
<p>Vamos a cambiar la versión de la imagen de Nginx a 1.15.0 en el archivo deployment.yaml:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.15.0</span>
</code></pre>
<p>Ahora que hemos hecho los cambios en deployment.yaml, necesitamos aplicar las modificaciones al Despliegue. Para ello, debemos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl apply -f deployment.yaml
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment configured
</code></pre>
<p>Vamos a verificar los Pods del Despliegue:</p>
<pre><code class="lang-bash">kubectl get pods -l app=nginx-deployment
</code></pre>
<p>También vamos a verificar la versión de la imagen de Nginx en el Pod:</p>
<pre><code class="lang-bash">kubectl <span class="hljs-built_in">exec</span> -it nginx-deployment-7d9bcc6bc9-24c2j -- nginx -v
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">nginx version: nginx/1.15.0
</code></pre>
<p>Ahora, imaginemos que queremos revertir la actualización a la versión 1.16.0 de Nginx. Para lograrlo, necesitamos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl rollout undo deployment nginx-deployment
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment rolled back
</code></pre>
<p>Estamos en el proceso de indicarle a Kubernetes que deseamos revertir la actualización a la versión anterior del Despliegue.</p>
<p>Vamos a verificar los Pods del Despliegue:</p>
<pre><code class="lang-bash">kubectl get pods -l app=nginx-deployment
</code></pre>
<p>También verifiquemos la versión de la imagen de Nginx en el Pod:</p>
<pre><code class="lang-bash">kubectl <span class="hljs-built_in">exec</span> -it nginx-deployment-7d9bcc6bc9-24c2j -- nginx -v
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">nginx version: nginx/1.16.0
</code></pre>
<p>Listo, ahora tenemos la versión 1.16.0 de Nginx en funcionamiento en nuestro clúster y ya entendemos cómo hacer un rollback de una actualización. Pero, ¿cómo visualizamos el historial de actualizaciones del Despliegue?</p>
<p>Es sencillo, solo necesitamos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl rollout <span class="hljs-built_in">history</span> deployment nginx-deployment
</code></pre>
<p>Esto nos mostrará el historial de actualizaciones del Despliegue:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment 
REVISION  CHANGE-CAUSE
1         &lt;none&gt;
2         &lt;none&gt;
</code></pre>
<p>En salida del comando, podemos ver que tenemos dos revisiones del Despliegue, la revisión 1 y la revisión 2.</p>
<p>Vamos a verificar el historial de actualizaciones de la revisión 1:</p>
<pre><code class="lang-bash">kubectl rollout <span class="hljs-built_in">history</span> deployment nginx-deployment --revision=1
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment with revision <span class="hljs-comment">#1</span>
Pod Template:
  Labels: app=nginx-deployment
 pod-template-hash=c549ff78
  Containers:
   nginx:
    Image: nginx:1.16.0
    Port: &lt;none&gt;
    Host Port: &lt;none&gt;
    Limits:
      cpu: 500m
      memory: 256Mi
    Requests:
      cpu: 250m
      memory: 128Mi
    Environment: &lt;none&gt;
    Mounts: &lt;none&gt;
  Volumes: &lt;none&gt;
</code></pre>
<p>Vamos a verificar el historial de actualizaciones de la revisión 2:</p>
<pre><code class="lang-bash">kubectl rollout <span class="hljs-built_in">history</span> deployment nginx-deployment --revision=2
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment with revision <span class="hljs-comment">#2</span>
Pod Template:
  Labels: app=nginx-deployment
 pod-template-hash=7d9bcc6bc9
  Containers:
   nginx:
    Image: nginx:1.15.0
    Port: &lt;none&gt;
    Host Port: &lt;none&gt;
    Limits:
      cpu: 500m
      memory: 256Mi
    Requests:
      cpu: 250m
      memory: 128Mi
    Environment: &lt;none&gt;
    Mounts: &lt;none&gt;
  Volumes: &lt;none&gt;
</code></pre>
<p>Es decir, como podemos ver, la revisión 1 es la versión 1.16.0 de Nginx y la revisión 2 es la versión 1.15.0 de Nginx.</p>
<p>Si deseas hacer un rollback a la revisión 1, simplemente ejecuta el siguiente comando:</p>
<pre><code class="lang-bash">kubectl rollout undo deployment nginx-deployment --to-revision=1
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps/nginx-deployment rolled back
</code></pre>
<p>Genial, ahora tenemos la versión 1.16.0 de Nginx ejecutándose en nuestro clúster y ya entendemos cómo hacer un rollback de una actualización, ¿simple, verdad?</p>
<p>El comando <code>kubectl rollout</code> es muy útil para nosotros, ya que nos ayuda a visualizar el historial de actualizaciones del Deployment, realizar un rollback de una actualización y mucho más.</p>
<p>Hemos visto algunas opciones del comando <code>kubectl rollout</code>, como por ejemplo <code>kubectl rollout history</code>, <code>kubectl rollout undo</code> y <code>kubectl rollout status</code>, pero hay otras opciones que podemos utilizar. Veamos algunas de ellas:</p>
<pre><code class="lang-bash">kubectl rollout pause deployment nginx-deployment
</code></pre>
<p>El comando <code>kubectl rollout pause</code> se utiliza para pausar el Deployment, es decir, detendrá el Deployment y no permitirá que realice ninguna actualización.</p>
<pre><code class="lang-bash">kubectl rollout resume deployment nginx-deployment
</code></pre>
<p>El comando <code>kubectl rollout resume</code> se utiliza para reanudar el Deployment, es decir, lo reactivará y permitirá que realice actualizaciones nuevamente.</p>
<pre><code class="lang-bash">kubectl rollout restart deployment nginx-deployment
</code></pre>
<p>El comando <code>kubectl rollout restart</code> se utiliza para reiniciar el Deployment, es decir, lo reiniciará reemplazando los Pods actuales por nuevos.</p>
<pre><code class="lang-bash">kubectl rollout status deployment nginx-deployment
</code></pre>
<p>El comando <code>kubectl rollout status</code> se utiliza para verificar el estado del Deployment, es decir, verifica el estado del rollout del Deployment.</p>
<pre><code class="lang-bash">kubectl rollout undo deployment nginx-deployment
</code></pre>
<p>El comando <code>kubectl rollout undo</code> se utiliza para hacer un rollback de una actualización, es decir, revertirá una actualización a la revisión anterior.</p>
<pre><code class="lang-bash">kubectl rollout <span class="hljs-built_in">history</span> deployment nginx-deployment
</code></pre>
<p>El comando <code>kubectl rollout history</code> se utiliza para ver el historial de actualizaciones del Deployment.</p>
<pre><code class="lang-bash">kubectl rollout <span class="hljs-built_in">history</span> deployment nginx-deployment --revision=1
</code></pre>
<p>Recuerda que podemos utilizar el comando <code>kubectl rollout</code> en Deployments, StatefulSets y DaemonSets.</p>
<p> </p>
<h4 id="eliminando-un-deployment">Eliminando un Deployment</h4>
<p>Para eliminar un Deployment, necesitamos ejecutar el siguiente comando:</p>
<pre><code class="lang-bash">kubectl delete deployment nginx-deployment
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps <span class="hljs-string">&quot;nginx-deployment&quot;</span> deleted
</code></pre>
<p>Si deseas eliminar el Deployment utilizando el manifiesto, simplemente ejecuta el siguiente comando:</p>
<pre><code class="lang-bash">kubectl delete -f deployment.yaml
</code></pre>
<p>El resultado será el siguiente:</p>
<pre><code class="lang-bash">deployment.apps <span class="hljs-string">&quot;nginx-deployment&quot;</span> deleted
</code></pre>
<p>¡Listo! Ahora hemos eliminado el Deployment de nuestro clúster.</p>
<p> </p>
<h4 id="conclusión">Conclusión</h4>
<p>Durante el día de hoy, hemos aprendido qué es un Deployment, cómo crear uno, cómo actualizarlo, cómo realizar un rollback de una actualización, cómo eliminarlo y mucho más. Con esto, hemos obtenido una sólida base para comenzar a trabajar con Deployments en Kubernetes.</p>
<p>Aún exploraremos mucho más sobre Deployments y conoceremos muchas otras opciones que nos ofrecen, pero por ahora eso es todo. Espero que hayan disfrutado y aprendido mucho del contenido de hoy.</p>
<h1 id="vaiiii">VAIIII</h1>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../day-2/" class="navigation navigation-prev " aria-label="Previous page: Simplificando Kubernetes día 2">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../day-4/" class="navigation navigation-next " aria-label="Next page: Simplificando Kubernetes día 4">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Simplificando Kubernetes día 3","level":"2.3","depth":1,"next":{"title":"Simplificando Kubernetes día 4","level":"2.4","depth":1,"path":"day-4/README.md","ref":"day-4/README.md","articles":[]},"previous":{"title":"Simplificando Kubernetes día 2","level":"2.2","depth":1,"path":"day-2/README.md","ref":"day-2/README.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"es","gitbook":"*"},"file":{"path":"day-3/README.md","mtime":"2024-03-01T16:10:55.392Z","type":"markdown"},"gitbook":{"version":"3.6.20","time":"2024-03-01T16:11:09.018Z"},"basePath":"..","book":{"language":"es"}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

